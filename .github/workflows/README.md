# GitHub Actions Workflows

## ğŸ“ Ğ¤Ğ°Ğ¹Ğ»Ñ‹ Ğ² ÑÑ‚Ğ¾Ğ¹ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¸

### ci.yml - ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ CI/CD Pipeline

**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ:** ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ÑĞ±Ğ¾Ñ€ĞºĞ°, Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Docker Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²

**Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹:**
- Push Ğ²: `main`, `master`, `develop`
- Pull Request Ğ²: `main`, `master`, `develop`

**Jobs:**

#### 1ï¸âƒ£ test
- Ğ—Ğ°Ğ¿ÑƒÑĞº: Ğ¿Ñ€Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ push/PR
- ĞŸĞ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ°: Ubuntu Latest
- Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ:
  - âœ… Checkout ĞºĞ¾Ğ´Ğ°
  - âœ… Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° JDK 17 (Temurin)
  - âœ… Maven dependency caching
  - âœ… Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ²: `mvn clean test`
  - âœ… Upload test results (Ğ°Ñ€Ñ‚ĞµÑ„Ğ°ĞºÑ‚Ñ‹)

#### 2ï¸âƒ£ build-and-push
- Ğ—Ğ°Ğ¿ÑƒÑĞº: Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€Ğ¸ push (Ğ½Ğµ PR) Ğ¸ Ğ¿Ğ¾ÑĞ»Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ³Ğ¾ test
- ĞŸĞ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ°: Ubuntu Latest
- Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ:
  - âœ… Checkout ĞºĞ¾Ğ´Ğ°
  - âœ… Setup Docker Buildx
  - âœ… Login Ğ² DockerHub (secrets)
  - âœ… Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Docker metadata & tags
  - âœ… Build & Push Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ°
  - âœ… Ğ’Ñ‹Ğ²Ğ¾Ğ´ digest Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ°

## ğŸ” ĞĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ğµ Secrets

Ğ’ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ñ… Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ñ‹:

| Secret | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|--------|----------|
| `DOCKER_USERNAME` | DockerHub username |
| `DOCKER_TOKEN` | DockerHub Personal Access Token |

ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ°Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ: [GITHUB-SECRETS-SETUP.md](../../GITHUB-SECRETS-SETUP.md)

## ğŸ·ï¸ Docker Tags

ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒÑÑ‚ÑÑ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ Ñ‚ĞµĞ³Ğ¸:

| Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ | Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ğµ Ñ‚ĞµĞ³Ğ¸ |
|---------|-------------------|
| Push Ğ² `main` | `latest`, `main`, `main-{sha}` |
| Push Ğ² `develop` | `develop`, `develop-{sha}` |
| Push Ğ² `master` | `latest`, `master`, `master-{sha}` |

Ğ³Ğ´Ğµ `{sha}` - ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹ SHA ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚Ğ°

## ğŸ“Š ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

### Ğ’ GitHub:
1. ĞŸĞµÑ€ĞµĞ¹Ñ‚Ğ¸ Ğ²Ğ¾ Ğ²ĞºĞ»Ğ°Ğ´ĞºÑƒ **Actions**
2. ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ workflow run
3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ job

### Ğ’ DockerHub:
1. ĞŸĞµÑ€ĞµĞ¹Ñ‚Ğ¸ Ğ½Ğ° https://hub.docker.com/r/elbondarenko04121/auth-service
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº Ñ‚ĞµĞ³Ğ¾Ğ²
3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ³Ğ¾ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ

## âš¡ ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

### Maven Caching
```yaml
cache: maven
```
ĞšÑÑˆĞ¸Ñ€ÑƒĞµÑ‚ `~/.m2/repository` Ğ´Ğ»Ñ ÑƒÑĞºĞ¾Ñ€ĞµĞ½Ğ¸Ñ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹

### Docker Layer Caching
```yaml
cache-from: type=registry,ref=elbondarenko04121/auth-service:buildcache
cache-to: type=registry,ref=elbondarenko04121/auth-service:buildcache,mode=max
```
Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ registry Ğ´Ğ»Ñ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ ĞºÑÑˆĞ° ÑĞ»Ğ¾ĞµĞ² Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞ±Ğ¾Ñ€ĞºĞ°Ğ¼Ğ¸

### Docker Buildx
```yaml
uses: docker/setup-buildx-action@v3
```
Ğ’ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ advanced Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Docker, Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ğ¾Ğµ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

## ğŸ”„ Flow Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Developer Push    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GitHub Actions     â”‚
â”‚     Triggered       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Job: test         â”‚
â”‚   â”œâ”€ Setup JDK      â”‚
â”‚   â”œâ”€ Cache Maven    â”‚
â”‚   â””â”€ Run tests      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
      âœ… Success?
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Job: build-and-push â”‚
â”‚ (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ push)   â”‚
â”‚   â”œâ”€ Setup Buildx   â”‚
â”‚   â”œâ”€ Login DockerHubâ”‚
â”‚   â”œâ”€ Generate tags  â”‚
â”‚   â””â”€ Build & Push   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    DockerHub        â”‚
â”‚  Image Published!   â”‚
â”‚ elbondarenko04121/  â”‚
â”‚    auth-service     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº

Workflow Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ Ñ‡ĞµÑ€ĞµĞ· GitHub UI:

1. ĞŸĞµÑ€ĞµĞ¹Ñ‚Ğ¸ Ğ² **Actions**
2. Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ workflow **Auth Service CI/CD**
3. ĞĞ°Ğ¶Ğ°Ñ‚ÑŒ **Run workflow**
4. Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ²ĞµÑ‚ĞºÑƒ
5. ĞĞ°Ğ¶Ğ°Ñ‚ÑŒ Ğ·ĞµĞ»ĞµĞ½ÑƒÑ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ **Run workflow**

## ğŸ“ Logs Ğ¸ Artifacts

### Logs
- Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ğ² ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ workflow run
- Ğ¥Ñ€Ğ°Ğ½ÑÑ‚ÑÑ 90 Ğ´Ğ½ĞµĞ¹ (default GitHub)
- ĞœĞ¾Ğ¶Ğ½Ğ¾ ÑĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°

### Artifacts
- **test-results**: XML Ğ¾Ñ‚Ñ‡ĞµÑ‚Ñ‹ Surefire
- Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ğ´Ğ»Ñ ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾ÑĞ»Ğµ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°
- Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½ÑƒÑ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ‚ĞµÑÑ‚Ğ°Ñ…

## ğŸ†˜ Troubleshooting

### Workflow Ğ½Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ push Ğ² Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½ÑƒÑ Ğ²ĞµÑ‚ĞºÑƒ
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ workflow Ñ„Ğ°Ğ¹Ğ» ÑĞ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸Ñ‡ĞµÑĞºĞ¸ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚ĞµĞ½
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ GitHub Actions Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹ Ğ² Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¸

### Test job Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚
- âœ… Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ñ‹ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾: `mvn clean test`
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸ Ğ² Actions
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ² ĞºĞ¾Ğ´Ğµ

### Build-and-push job Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ ÑĞµĞºÑ€ĞµÑ‚Ñ‹ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ñ‹
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ñ‚Ğ¾ĞºĞµĞ½ DockerHub Ğ²Ğ°Ğ»Ğ¸Ğ´ĞµĞ½
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ½Ğ° DockerHub
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ°Ğ²Ğ° Ñ‚Ğ¾ĞºĞµĞ½Ğ° (Read & Write)

## ğŸ“š Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

- [CI-CD-SETUP.md](../../CI-CD-SETUP.md) - Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ CI/CD
- [GITHUB-SECRETS-SETUP.md](../../GITHUB-SECRETS-SETUP.md) - Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° ÑĞµĞºÑ€ĞµÑ‚Ğ¾Ğ²
- [QUICKSTART.md](../../QUICKSTART.md) - Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚
- [SUMMARY.md](../../SUMMARY.md) - Ğ¸Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ¾Ñ‚Ñ‡ĞµÑ‚

## ğŸ”— ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ÑÑÑ‹Ğ»ĞºĞ¸

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [Docker Build Push Action](https://github.com/docker/build-push-action)
- [Docker Metadata Action](https://github.com/docker/metadata-action)
- [GitHub Actions Secrets](https://docs.github.com/en/actions/security-guides/encrypted-secrets)

